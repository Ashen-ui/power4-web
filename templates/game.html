<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="/static/image/logo.png">
  <link rel="stylesheet" href="/static/css/style.css">
  <title>Puissance 4</title>
</head>
<body>
  <h1>Puissance 4</h1>

  <div class="scores" style="display:flex; gap:20px; align-items:center;">
    <div class="score">Rouge: <span class="score-value">{{.WinsX}}</span></div>
    <div class="score">Bleu: <span class="score-value">{{.WinsO}}</span></div>
  </div>

  <div class="current-player" style="margin-top:12px;">
    {{if .Winner}}
      <div class="game-over">
        {{if eq .Winner "Draw"}}
          <strong>Match nul !</strong>
        {{else}}
          <strong>Le gagnant est :</strong>
          <img src="{{if eq .Winner "X"}}/static/image/jeton_rouge.png{{else}}/static/image/jeton_bleu.png{{end}}" class="player-indicator" alt="winner">
        {{end}}
      </div>
    {{else}}
      <div>Au tour de :
        {{if eq .Turn "| X |"}}
          <img src="/static/image/jeton_rouge.png" class="player-indicator" alt="Rouge">
        {{else if eq .Turn "| O |"}}
          <img src="/static/image/jeton_bleu.png" class="player-indicator" alt="Bleu">
        {{else}}
          <span>—</span>
        {{end}}
      </div>
    {{end}}
  </div>

  <div class="plateau" style="display:flex; gap:8px; margin-top:16px; justify-content:center;">
    {{range $colIndex, $_ := index .Grid 0}}
      <div class="colonne">
        {{if not $.Winner}}
          <form method="post" action="/play" class="column-form">
            <input type="hidden" name="col" value="{{$colIndex}}">
            <button class="play-btn" type="submit">↓</button>
          </form>
        {{end}}

        {{range $rowIndex, $row := $.Grid}}
          <div class="cellule">
            {{ $cell := index $row $colIndex }}
            {{if eq $cell "| X |"}}
              <img src="/static/image/jeton_rouge.png" alt="R">
            {{else if eq $cell "| O |"}}
              <img src="/static/image/jeton_bleu.png" alt="B">
            {{end}}
          </div>
        {{end}}
      </div>
    {{end}}
  </div>

  <div class="controls" style="margin-top:30px; display:flex; gap:20px; justify-content:center;">
    <form method="post" action="/play">
      <input type="hidden" name="action" value="menu">
      <button class="btn btn-secondary" type="submit">Menu</button>
    </form>

    <form method="post" action="/play">
      <input type="hidden" name="action" value="reset">
      <button class="btn btn-primary" type="submit">Reset Partie</button>
    </form>

    <form method="post" action="/play">
      <input type="hidden" name="action" value="reset_scores">
      <button class="btn btn-primary" type="submit">Reset Jeu + Scores</button>
    </form>
  </div>
</body>
</html>
